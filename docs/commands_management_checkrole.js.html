<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: commands/management/checkrole.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: commands/management/checkrole.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Discord = require('discord.js');
const { Command } = require('discord.js-commando');
const functions = require('../../modules/functions.js');
const constants = require('../../modules/constants.js');
/** @type {import('../../modules/app.js')} */
let app;

module.exports = class CheckRole extends Command {
    constructor(client) {
        super(client, {
            name: 'checkrole',
            group: 'management',
            memberName: 'checkrole',
            description: '[Mod] Gets the permissions of a member or a role in a channel.',
            guildOnly: true,
            args: [
                {
                    key: 'Channel',
                    prompt: 'Mention the target channel/ID.',
                    type: 'string',
                    validate: Channel => {
                        // Link
                        const Modules = functions.parseModules(GlobalModules);
                        app = Modules.app;

                        if (app.channel(Channel))
                            return true;
                        return false;
                    }
                },
                {
                    key: 'MemberOrRole',
                    prompt: 'Mention the member/ID or role/ID you want to check.',
                    type: 'string',
                    validate: MemberOrRole => {
                        let isValid = false;
                        for (const this_MemberOrRole of String(MemberOrRole).split(' ')) {
                            if (app.member(this_MemberOrRole) || app.role(this_MemberOrRole)) {
                                isValid = true;
                                break;
                            }
                        }
                        return isValid;
                    }
                }
            ]
        });
    }

    /**
     * @param {Discord.Message} message 
     * @param {{Channel: Discord.ChannelResolvable, MemberOrRole: String}} 
     */
    async run(message, { Channel, MemberOrRole }) {
        // Check user permissions
        if (!app.hasRole(message.author, [constants.roles.staff, constants.roles.moderator])) {
            return message.reply("You don't have permissions to use this command.");
        }

        const this_channel = app.channel(Channel);
        for (const this_MemberOrRole of MemberOrRole.split(' ')) {
            const this_object = app.member(this_MemberOrRole) || app.role(this_MemberOrRole);
            if (!this_object) continue;
            const object_permissions = this_channel.permissionsFor(this_object);
            const embed = new Discord.MessageEmbed();
            embed.setAuthor('Quarantine Gaming: Bitwise Permission Flags');
            embed.setTitle('Channel Permissions')
            embed.setDescription(`${this_object} permissions on ${this_channel} channel.`);
            // General Permissions
            const general_permissions = new Array();
            for (const this_permission of Object.entries(constants.permissions.general)) {
                general_permissions.push({
                    name: this_permission[0].split('_').map(text => text.substring(0, 1).toUpperCase() + text.slice(1).toLowerCase()).join(' '),
                    value: object_permissions.has(this_permission[1])
                });
            }
            embed.addField('General Category Permissions', general_permissions.map(permission => `${permission.name}: ${permission.value ? '✅' : '❌'}`).join('\n'));
            // Type-Specific Permissions
            const type_specific_permissions = new Array();
            switch (this_channel.type) {
                case 'text':
                    for (const this_permission of Object.entries(constants.permissions.text)) {
                        type_specific_permissions.push({
                            name: this_permission[0].split('_').map(text => text.substring(0, 1).toUpperCase() + text.slice(1).toLowerCase()).join(' '),
                            value: object_permissions.has(this_permission[1])
                        });
                    }
                    embed.addField('Text Channel Permissions', type_specific_permissions.map(permission => `${permission.name}: ${permission.value ? '✅' : '❌'}`).join('\n'));
                    break;
                case 'voice':
                    for (const this_permission of Object.entries(constants.permissions.voice)) {
                        type_specific_permissions.push({
                            name: this_permission[0].split('_').map(text => text.substring(0, 1).toUpperCase() + text.slice(1).toLowerCase()).join(' '),
                            value: object_permissions.has(this_permission[1])
                        });
                    }
                    embed.addField('Voice Channel Permissions', type_specific_permissions.map(permission => `${permission.name}: ${permission.value ? '✅' : '❌'}`).join('\n'));
                    break;
            }
            embed.setFooter(`Channel ID: ${this_object.id}`);
            embed.setTimestamp();
            embed.setColor('#ffff00');
            message.say(embed);
        }
    }
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ErrorTicket.html">ErrorTicket</a></li><li><a href="ErrorTicketManager.html">ErrorTicketManager</a></li><li><a href="Notification.html">Notification</a></li><li><a href="ProcessQueue.html">ProcessQueue</a></li></ul><h3>Global</h3><ul><li><a href="global.html#add">add</a></li><li><a href="global.html#addReaction">addReaction</a></li><li><a href="global.html#app">app</a></li><li><a href="global.html#blacklisted">blacklisted</a></li><li><a href="global.html#channel">channel</a></li><li><a href="global.html#channel_manager">channel_manager</a></li><li><a href="global.html#clearTempChannels">clearTempChannels</a></li><li><a href="global.html#client">client</a></li><li><a href="global.html#compareArray">compareArray</a></li><li><a href="global.html#compareDate">compareDate</a></li><li><a href="global.html#compareString">compareString</a></li><li><a href="global.html#contains">contains</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#createStructure">createStructure</a></li><li><a href="global.html#database">database</a></li><li><a href="global.html#DB">DB</a></li><li><a href="global.html#dedicateChannel">dedicateChannel</a></li><li><a href="global.html#delete">delete</a></li><li><a href="global.html#error_manager">error_manager</a></li><li><a href="global.html#fetchIcon">fetchIcon</a></li><li><a href="global.html#fetchImage">fetchImage</a></li><li><a href="global.html#freeGameFetch">freeGameFetch</a></li><li><a href="global.html#freeGameNotify">freeGameNotify</a></li><li><a href="global.html#freeGameUpdate">freeGameUpdate</a></li><li><a href="global.html#gameBlacklist">gameBlacklist</a></li><li><a href="global.html#gameInvite">gameInvite</a></li><li><a href="global.html#gameTitles">gameTitles</a></li><li><a href="global.html#gameWhitelist">gameWhitelist</a></li><li><a href="global.html#general">general</a></li><li><a href="global.html#guild">guild</a></li><li><a href="global.html#hasRole">hasRole</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initialized">initialized</a></li><li><a href="global.html#isInitialized">isInitialized</a></li><li><a href="global.html#mark">mark</a></li><li><a href="global.html#member">member</a></li><li><a href="global.html#memberActivityUpdate">memberActivityUpdate</a></li><li><a href="global.html#memberOffline">memberOffline</a></li><li><a href="global.html#memberUnlisted">memberUnlisted</a></li><li><a href="global.html#memberVoiceUpdate">memberVoiceUpdate</a></li><li><a href="global.html#message">message</a></li><li><a href="global.html#message_manager">message_manager</a></li><li><a href="global.html#notificationPush">notificationPush</a></li><li><a href="global.html#notificationRecords">notificationRecords</a></li><li><a href="global.html#notifications">notifications</a></li><li><a href="global.html#notificationTrim">notificationTrim</a></li><li><a href="global.html#onReactionAdd">onReactionAdd</a></li><li><a href="global.html#onReactionRemove">onReactionRemove</a></li><li><a href="global.html#parseHTML">parseHTML</a></li><li><a href="global.html#parseMention">parseMention</a></li><li><a href="global.html#parseModules">parseModules</a></li><li><a href="global.html#process">process</a></li><li><a href="global.html#reaction_manager">reaction_manager</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#role">role</a></li><li><a href="global.html#role_manager">role_manager</a></li><li><a href="global.html#say">say</a></li><li><a href="global.html#sendToChannel">sendToChannel</a></li><li><a href="global.html#sendToUser">sendToUser</a></li><li><a href="global.html#setActivity">setActivity</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#speech">speech</a></li><li><a href="global.html#toAlphanumericString">toAlphanumericString</a></li><li><a href="global.html#toCountingInteger">toCountingInteger</a></li><li><a href="global.html#whitelisted">whitelisted</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Wed Jan 27 2021 19:14:34 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
